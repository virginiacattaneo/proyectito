<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>My Aplicación con Sockets</title>
    <script src="/socket.io/socket.io.js"></script>
    <script src="main.js"></script>
    <script src="http://js.nicedit.com/nicEdit-latest.js" type="text/javascript"></script>
    <script type="text/javascript">bkLib.onDomLoaded(nicEditors.allTextAreas);</script>
    <script src="main.js"></script>
    
    <script>
    window.onload = function() {
        inactivityTime(); 
      }</script>
     
  </head>
  <body>
    <ul>
    </ul>
    
    <script>
      
      function getParameterByName(name) {
        name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
        var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
        results = regex.exec(location.search);
        return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
      }
      var idrecuperado=getParameterByName("examencod");
      console.log(idrecuperado);
      var myList = document.querySelector('ul');
      var myList1 = document.querySelector('ul');
    

     fetch('examenalumno.json').then(function(response) {
      if (!response.ok) {
        throw new Error("HTTP error, status = " + response.status);
      }
      return response.json();
    })
    .then(function(json) {
      for(var i = 0; i < json.examenes.length; i++) {
        var idbuscado= json.examenes[i].id;
       
       if(idbuscado == idrecuperado){
        console.log(idbuscado);
        var listItem = document.createElement('li');
        listItem.innerHTML +=' Alumno: ' + json.examenes[i].alumnoasignado ;
        '<br>'+'Preguntas'+'<br>';
        var preguntas=json.examenes[i].examenes.length;
        for(var j = 0; j < preguntas; j++) {
          var listItem1 = document.createElement('li');
            listItem1.innerHTML += ' Sección: <strong>' +json.examenes[i].examenes[j].seccion + '</strong><br>';
            listItem1.innerHTML += ' Titulo: <strong>' +json.examenes[i].examenes[j].title + '</strong><br>';
            listItem1.innerHTML += ' Descripcion: <strong>' +json.examenes[i].examenes[j].descripcion + '</strong><br>';
            if (json.examenes[i].examenes[j].opciones == 'Respuesta corta'){
              listItem1.innerHTML += '<textarea class="floating-form-control floating-textarea"></textarea>';
            }
            if (json.examenes[i].examenes[j].opciones == 'Varias opciones'){
              var preguntasvarias=json.examenes[i].examenes.length;
              for(var k = 0; k < preguntasvarias; k++) {
                 listItem1.innerHTML += '<input type="checkbox">'+json.examenes[i].examenes[j].titleopcion[k] + '</label><br>'
              }
            }

            myList1.appendChild(listItem1);
          }
        myList.appendChild(listItem);
      }}
    })
    .catch(function(error) {
      var p = document.createElement('p');
      p.appendChild(
        document.createTextNode('Error: ' + error.message)
      );
      document.body.insertBefore(p, myList);
      document.body.insertBefore(p, myList1);
    });

    </script>
    
    <div id="canvas" width="2000" height="1000">
    <h1>¡Bienvenido a tu examen!</h1>
    <div id="messages"></div>
    <br/>
    <form onsubmit="return addMessage(this)">
      <input type="text" id="username" placeholder="Tu Nombre y apellido" /> <br><br>
      <input type="text" id="texto" placeholder="Ingresa el código del Examen" />
      <input type="submit" value="Enviar!" />
    </form>
   
</div>        
     </body>
</html>
